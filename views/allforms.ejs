<!DOCTYPE html>
<html>
<head>
  <title>Qu·∫£n L√Ω D·ªØ Li·ªáu Gi√°o D·ª•c</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 20px;
    }
    .tabs {
      display: flex;
      margin-bottom: 20px;
      border-bottom: 1px solid #ccc;
      flex-wrap: wrap;
    }
    .tab {
      padding: 10px 15px;
      cursor: pointer;
      margin-right: 5px;
      margin-bottom: 5px;
      background-color: #f8f8f8;
      border: 1px solid #ddd;
      border-bottom: none;
      border-radius: 5px 5px 0 0;
    }
    .tab.active {
      background-color: #fff;
      border-bottom: 2px solid #4CAF50;
      font-weight: bold;
    }
    .tab-content {
      display: none;
      padding: 20px;
      border: 1px solid #ccc;
      border-radius: 0 5px 5px 5px;
      background-color: #fff;
    }
    .tab-content.active {
      display: block;
    }
    form {
      max-width: 600px;
    }
    label {
      display: inline-block;
      width: 220px;
      margin-bottom: 10px;
      font-weight: bold;
    }
    input {
      margin-bottom: 10px;
      padding: 8px;
      width: 300px;
      border: 1px solid #ddd;
      border-radius: 4px;
    }
    input[type="checkbox"] {
      width: auto;
      margin-right: 10px;
    }
    button {
      padding: 10px 18px;
      background-color: #4CAF50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 14px;
      margin-top: 10px;
    }
    button:hover {
      background-color: #45a049;
    }
    .message {
      margin: 10px 0 20px 0;
      padding: 12px;
      background-color: #f8f8f8;
      border-left: 5px solid #4CAF50;
      border-radius: 4px;
    }
    .import-section {
      margin-bottom: 20px;
      padding: 15px;
      border: 1px solid #ddd;
      border-radius: 5px;
      background-color: #f9f9f9;
    }
    .import-section h3 {
      margin-top: 0;
      color: #333;
      border-bottom: 1px solid #eee;
      padding-bottom: 8px;
    }
    .form-group {
      margin-bottom: 15px;
    }
    .form-title {
      border-bottom: 2px solid #eee;
      padding-bottom: 10px;
      margin-bottom: 20px;
      color: #333;
    }
  </style>
</head>
<body>
  <h1>Qu·∫£n L√Ω D·ªØ Li·ªáu Gi√°o D·ª•c</h1>
  
  <% if (message) { %>
    <div class="message"><%= message %></div>
  <% } %>
  
  <div class="tabs">
    <div class="tab <%= activeTab === 'chuongTrinh' ? 'active' : '' %>" onclick="showTab('chuongTrinh')">Ch∆∞∆°ng Tr√¨nh</div>
    <div class="tab <%= activeTab === 'chuyenNganh' ? 'active' : '' %>" onclick="showTab('chuyenNganh')">Chuy√™n Ng√†nh</div>
    <div class="tab <%= activeTab === 'donVi' ? 'active' : '' %>" onclick="showTab('donVi')">ƒê∆°n V·ªã</div>
    <div class="tab <%= activeTab === 'monHoc' ? 'active' : '' %>" onclick="showTab('monHoc')">M√¥n H·ªçc</div>
    <div class="tab <%= activeTab === 'diemSinhVien' ? 'active' : '' %>" onclick="showTab('diemSinhVien')">ƒêi·ªÉm Sinh Vi√™n</div>
    <div class="tab <%= activeTab === 'hienDienSV' ? 'active' : '' %>" onclick="showTab('hienDienSV')">Hi·ªán Di·ªán SV</div>
    <div class="tab <%= activeTab === 'monHocTieuChi' ? 'active' : '' %>" onclick="showTab('monHocTieuChi')">M√¥n H·ªçc Ti√™u Ch√≠</div>
    <div class="tab <%= activeTab === 'tieuChiDauRa' ? 'active' : '' %>" onclick="showTab('tieuChiDauRa')">Ti√™u Ch√≠ ƒê·∫ßu Ra</div>
    <div class="tab <%= activeTab === 'tinhDiemTieuChi' ? 'active' : '' %>" onclick="showTab('tinhDiemTieuChi')">T√≠nh ƒêi·ªÉm Ti√™u Ch√≠</div>
    <div class="tab <%= activeTab === 'importData' ? 'active' : '' %>" onclick="showTab('importData')">Import Excel</div>
  </div>
  
  <!-- Tab 1: Ch∆∞∆°ng Tr√¨nh -->
  <div id="chuongTrinh" class="tab-content <%= activeTab === 'chuongTrinh' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p Ch∆∞∆°ng Tr√¨nh ƒê√†o T·∫°o</h2>
    <form method="POST" action="/chuongtrinh/save">
      <div class="form-group">
        <label>M√£ Kh·ªëi:</label>
        <input name="MaKhoi" required>
      </div>
      <div class="form-group">
        <label>M√£ Ng√†nh Ch∆∞∆°ng Tr√¨nh:</label>
        <input name="MaNgChng">
      </div>
      <div class="form-group">
        <label>B·∫≠c ƒê√†o T·∫°o:</label>
        <input name="BacDaoTao">
      </div>
      <div class="form-group">
        <label>H·ªá ƒê√†o T·∫°o:</label>
        <input name="HeDaoTao">
      </div>
      <div class="form-group">
        <label>M√£ ƒê∆°n V·ªã:</label>
        <input name="MaDV">
      </div>
      <div class="form-group">
        <label>H·ªçc K·ª≥ V√†o:</label>
        <input type="number" name="HocKyVao">
      </div>
      <button type="submit">L∆∞u Ch∆∞∆°ng Tr√¨nh</button>
    </form>
  </div>
  
  <!-- Tab 2: Chuy√™n Ng√†nh -->
  <div id="chuyenNganh" class="tab-content <%= activeTab === 'chuyenNganh' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p Chuy√™n Ng√†nh</h2>
    <form method="POST" action="/chuyennganh/save">
      <div class="form-group">
        <label>M√£ Chuy√™n Ng√†nh:</label>
        <input name="MaCN" required>
      </div>
      <div class="form-group">
        <label>T√™n Chuy√™n Ng√†nh:</label>
        <input name="TenCN">
      </div>
      <div class="form-group">
        <label>M√£ ƒê∆°n V·ªã:</label>
        <input name="MaDV">
      </div>
      <button type="submit">L∆∞u Chuy√™n Ng√†nh</button>
    </form>
  </div>
  
  <!-- Tab 3: ƒê∆°n V·ªã -->
  <div id="donVi" class="tab-content <%= activeTab === 'donVi' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p ƒê∆°n V·ªã</h2>
    <form method="POST" action="/donvi/save">
      <div class="form-group">
        <label>M√£ ƒê∆°n V·ªã:</label>
        <input name="MaDV" required>
      </div>
      <div class="form-group">
        <label>T√™n ƒê∆°n V·ªã:</label>
        <input name="TenDV">
      </div>
      <button type="submit">L∆∞u ƒê∆°n V·ªã</button>
    </form>
  </div>
  
  <!-- Tab 4: M√¥n H·ªçc -->
  <div id="monHoc" class="tab-content <%= activeTab === 'monHoc' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p M√¥n H·ªçc</h2>
    <form method="POST" action="/monhoc/save">
      <div class="form-group">
        <label>M√£ M√¥n H·ªçc:</label>
        <input name="MaMH" required>
      </div>
      <div class="form-group">
        <label>T√™n M√¥n H·ªçc:</label>
        <input name="TenMH">
      </div>
      <div class="form-group">
        <label>S·ªë Ti·∫øt M√¥n H·ªçc:</label>
        <input type="number" name="SoTietMH">
      </div>
      <div class="form-group">
        <label>S·ªë T√≠n Ch·ªâ:</label>
        <input type="number" name="SoTinChi">
      </div>
      <div class="form-group">
        <label>M√£ ƒê∆°n V·ªã:</label>
        <input name="MaDV">
      </div>
      <button type="submit">L∆∞u M√¥n H·ªçc</button>
    </form>
  </div>
  
  <!-- Tab 5: ƒêi·ªÉm Sinh Vi√™n -->
  <div id="diemSinhVien" class="tab-content <%= activeTab === 'diemSinhVien' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p ƒêi·ªÉm Sinh Vi√™n</h2>
    <form method="POST" action="/diemsinhvien/save">
      <div class="form-group">
        <label>M√£ Sinh Vi√™n:</label>
        <input name="MaSV" required>
      </div>
      <div class="form-group">
        <label>M√£ M√¥n H·ªçc:</label>
        <input name="MaMH" required>
      </div>
      <div class="form-group">
        <label>Nh√≥m H·ªçc:</label>
        <input name="NhomHoc" required>
      </div>
      <div class="form-group">
        <label>Qu√° Tr√¨nh:</label>
        <input name="QuaTrinh">
      </div>
      <div class="form-group">
        <label>Gi·ªØa K·ª≥:</label>
        <input name="GiuaKy">
      </div>
      <div class="form-group">
        <label>Cu·ªëi K·ª≥:</label>
        <input name="CuoiKy">
      </div>
      <div class="form-group">
        <label>ƒêi·ªÉm HP:</label>
        <input name="DiemHP">
      </div>
      <div class="form-group">
        <label>ƒêi·ªÉm S·ªë HP:</label>
        <input name="DiemSoHP">
      </div>
      <div class="form-group">
        <label>ƒêi·ªÉm Ch·ªØ HP:</label>
        <input name="DiemChuHP">
      </div>
      <div class="form-group">
        <label>NƒÉm H·ªçc K·ª≥:</label>
        <input type="number" name="NamHK" required>
      </div>
      <button type="submit">L∆∞u ƒêi·ªÉm Sinh Vi√™n</button>
    </form>
  </div>
  
  <!-- Tab 6: Hi·ªán Di·ªán SV -->
  <div id="hienDienSV" class="tab-content <%= activeTab === 'hienDienSV' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p Hi·ªán Di·ªán Sinh Vi√™n</h2>
    <form method="POST" action="/hiendiensv/save">
      <div class="form-group">
        <label>Hi·ªán Di·ªán SV:</label>
        <input type="checkbox" name="HienDienSV">
      </div>
      <div class="form-group">
        <label>M√£ Sinh Vi√™n:</label>
        <input name="MaSV" required>
      </div>
      <div class="form-group">
        <label>M√£ Khoa:</label>
        <input name="MaKhoa" required>
      </div>
      <div class="form-group">
        <label>M√£ Ng√†nh Ch∆∞∆°ng Tr√¨nh:</label>
        <input name="MaNgChng" required>
      </div>
      <div class="form-group">
        <label>M√£ Kh·ªëi:</label>
        <input name="MaKhoi" required>
      </div>
      <div class="form-group">
        <label>NƒÉm H·ªçc K·ª≥:</label>
        <input type="number" name="NamHocKy" required>
      </div>
      <button type="submit">L∆∞u Hi·ªán Di·ªán Sinh Vi√™n</button>
    </form>
  </div>
  
  <!-- Tab 7: M√¥n H·ªçc Ti√™u Ch√≠ -->
  <div id="monHocTieuChi" class="tab-content <%= activeTab === 'monHocTieuChi' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p M√¥n H·ªçc Ti√™u Ch√≠</h2>
    <form method="POST" action="/monhoctieuchi/save">
      <div class="form-group">
        <label>M√£ Ti√™u Ch√≠:</label>
        <input name="MaTieuChi" required>
      </div>
      <div class="form-group">
        <label>M√£ M√¥n H·ªçc:</label>
        <input name="MaMH" required>
      </div>
      <div class="form-group">
        <label>Lo·∫°i ƒêi·ªÉm:</label>
        <input name="LoaiDiem">
      </div>
      <div class="form-group">
        <label>ƒêi·ªÉm Ch·ªçn:</label>
        <input type="number" step="0.1" name="DiemChon">
      </div>
      <div class="form-group">
        <label>Tr·ªçng S·ªë:</label>
        <input type="number" step="0.1" name="TrongSo">
      </div>
      <button type="submit">L∆∞u M√¥n H·ªçc Ti√™u Ch√≠</button>
    </form>
  </div>
  
  <!-- Tab 8: Ti√™u Ch√≠ ƒê·∫ßu Ra -->
  <div id="tieuChiDauRa" class="tab-content <%= activeTab === 'tieuChiDauRa' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p Ti√™u Ch√≠ ƒê·∫ßu Ra</h2>
    <form method="POST" action="/tieuchidaura/save">
      <div class="form-group">
        <label>M√£ Ti√™u Ch√≠:</label>
        <input name="MaTieuChi" required>
      </div>
      <div class="form-group">
        <label>M√£ Kh·ªëi:</label>
        <input name="MaKhoi">
      </div>
      <div class="form-group">
        <label>M√£ Ng√†nh Ch∆∞∆°ng Tr√¨nh:</label>
        <input name="MaNgChng">
      </div>
      <div class="form-group">
        <label>M√£ ƒê∆°n V·ªã:</label>
        <input name="MaDV">
      </div>
      <div class="form-group">
        <label>Nh√≥m Ti√™u Ch√≠:</label>
        <input name="NhomTieuChi">
      </div>
      <div class="form-group">
        <label>M√£ PLO:</label>
        <input name="MaPLO">
      </div>
      <div class="form-group">
        <label>N·ªôi Dung Ti√™u Ch√≠:</label>
        <input name="NoiDungTieuChi">
      </div>
      <button type="submit">L∆∞u Ti√™u Ch√≠ ƒê·∫ßu Ra</button>
    </form>
  </div>
  
  <!-- Tab 9: T√≠nh ƒêi·ªÉm Ti√™u Ch√≠ -->
  <div id="tinhDiemTieuChi" class="tab-content <%= activeTab === 'tinhDiemTieuChi' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p T√≠nh ƒêi·ªÉm Ti√™u Ch√≠</h2>
    <form method="POST" action="/tinhdiemtieuchi/save">
      <div class="form-group">
        <label>M√£ Sinh Vi√™n:</label>
        <input name="MaSV">
      </div>
      <div class="form-group">
        <label>M√£ Ti√™u Ch√≠:</label>
        <input name="MaTieuChi">
      </div>
      <div class="form-group">
        <label>ƒêi·ªÉm T·ªïng K·∫øt:</label>
        <input type="number" step="0.1" name="DiemTongKet">
      </div>
      <div class="form-group">
        <label>M·ª©c ƒê·ªô ƒê·∫°t:</label>
        <input name="MucDoDat">
      </div>
      <button type="submit">L∆∞u T√≠nh ƒêi·ªÉm Ti√™u Ch√≠</button>
    </form>
  </div>

  <!-- Tab 10: Import Excel Data -->
  <div id="importData" class="tab-content <%= activeTab === 'importData' ? 'active' : '' %>">
    <h2 class="form-title">Nh·∫≠p D·ªØ Li·ªáu T·ª´ File Excel</h2>
    
    <div class="import-section">
      <h3>Import Hi·ªán Di·ªán Sinh Vi√™n</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: HienDienSV, MaSV, MaKhoa, MaNgChng, MaKhoi, NamHocKy</p>
      <form method="POST" action="/import/hiendiensv" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx" required>
        <button type="submit">Import</button>
      </form>
    </div>
    
    <div class="import-section">
      <h3>Import ƒê∆°n V·ªã</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaDV, TenDV</p>
      <form method="POST" action="/import/donvi" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx" required>
        <button type="submit">Import</button>
      </form>
    </div>
    
    <div class="import-section">
      <h3>Import Chuy√™n Ng√†nh</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaCN, TenCN, MaDV</p>
      <form method="POST" action="/import/chuyennganh" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx" required>
        <button type="submit">Import</button>
      </form>
    </div>
    
    <div class="import-section">
      <h3>Import Ch∆∞∆°ng Tr√¨nh</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaKhoi, MaNgChng, BacDaoTao, HeDaoTao, MaDV, HocKyVao</p>
      <form method="POST" action="/import/chuongtrinh" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx" required>
        <button type="submit">Import</button>
      </form>
    </div>
    
    <div class="import-section">
      <h3>Import Ti√™u Ch√≠ ƒê·∫ßu Ra</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaTieuChi, MaKhoi, MaNgChng, MaDV, NhomTieuChi, MaPLO, NoiDungTieuChi</p>
      <form method="POST" action="/import/tieuchidaura" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx" required>
        <button type="submit">Import</button>
      </form>
    </div>
    
    <div class="import-section">
      <h3>Import M√¥n H·ªçc Ti√™u Ch√≠</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaTieuChi, MaMH, LoaiDiem, DiemChon, TrongSo</p>
      <form method="POST" action="/import/monhoctieuchi" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx" required>
        <button type="submit">Import</button>
      </form>
    </div>
    <div class="import-section">
        <h3>Import M√¥n H·ªçc</h3>
        <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaMH, TenMH, SoTietMH, SoTinChi, MaDV</p>
        <form method="POST" action="/import/monhoc" enctype="multipart/form-data">
            <input type="file" name="excelFile" accept=".xlsx" required>
            <button type="submit">Import</button>
        </form>
    </div>
    <div class="import-section">
      <h3>Import ƒêi·ªÉm Sinh Vi√™n</h3>
      <p>T·∫£i l√™n file Excel v·ªõi c√°c c·ªôt: MaSV, MaMH, NhomHoc, QuaTrinh, GiuaKy, CuoiKy, DiemHP, DiemSoHP, DiemChuHP, NamHK</p>
      <form method="POST" action="/import/diemsinhvien" enctype="multipart/form-data">
        <input type="file" name="excelFile" accept=".xlsx,.xls" required>
        <button type="submit">Import</button>
      </form>
    </div>
    <div class="form-group">
      <h3>C·∫≠p nh·∫≠t DiemChon t·ª´ Ch∆∞∆°ng Tr√¨nh</h3>
      <p>T·ª± ƒë·ªông g·∫Øn DiemChon t·ª´ model ChuongTrinh v√†o MonHocTieuChi th√¥ng qua TieuChiDauRa</p>
      <form action="/update-diem-chon" method="post">
        <button type="submit" class="btn btn-warning" onclick="return confirm('B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën c·∫≠p nh·∫≠t DiemChon cho t·∫•t c·∫£ MonHocTieuChi? Thao t√°c n√†y kh√¥ng th·ªÉ ho√†n t√°c.')">
          üîÑ C·∫≠p nh·∫≠t DiemChon t·ª´ Ch∆∞∆°ng Tr√¨nh
        </button>
      </form>
      <form action="/debug-data-flow" method="post" style="display: inline;">
  <button type="submit" class="btn btn-primary">
    üîç Debug h∆∞·ªõng ƒëi d·ªØ li·ªáu
  </button>
</form>
    </div>
    <div class="import-section">
        <h3>Import T·ª∑ Tr·ªçng Chu·∫©n</h3>
        <p>T·∫£i l√™n file Excel v·ªõi PLO, c√°c h·ªçc k·ª≥ v√† ƒëi·ªÉm ch·ªçn. C·∫•u tr√∫c: PLO | HK1/1 | HK2/1 | ... | ƒêi·ªÉm ch·ªçn</p>
        <form method="POST" action="/import/TyTrongChuan" enctype="multipart/form-data">
            <input type="file" name="excelFile" accept=".xlsx,.xls" required>
            <button type="submit">Import</button>
        </form>
    </div>
    
  </div>

  <script>
    function showTab(tabId) {
      // Hide all tab contents
      const tabContents = document.querySelectorAll('.tab-content');
      tabContents.forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Deactivate all tabs
      const tabs = document.querySelectorAll('.tab');
      tabs.forEach(tab => {
        tab.classList.remove('active');
      });
      
      // Show selected tab content and activate the tab
      document.getElementById(tabId).classList.add('active');
      document.querySelector(`.tab[onclick="showTab('${tabId}')"]`).classList.add('active');
    }
  </script>
</body>
</html>